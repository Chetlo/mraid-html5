<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Ads :: Expandable mraid</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>

<body>

  <h2>Two part mraid template</h2>
  <p>Quo enim voluptatibus quo voluptas sint amet accusamus natus. ad quam voluptate qui debitis sapiente sit mollitia. alias aliquid voluptas saepe eveniet libero sint. quaerat consequatur nihil consequatur aliquam harum dolore dignissimos

    Ut et ab eum hic et eius itaque cum velit. est impedit numquam officiis qui odio rem nam iusto fuga. reprehenderit libero et in earum vero inventore aperiam quia et qui consequatur qui libero. est cum rerum inventore magnam nesciunt et labore hic deleniti

    Quaerat nesciunt cum velit quidem. sit molestiae exercitationem dolore nisi. voluptatem omnis id blanditiis sit officiis modi. consequatur debitis molestiae necessitatibus tempore sed aperiam maxime velit tempora qui sed omnis. consequatur eius adipisci expedita rerum culpa. est provident consequuntur ex minima provident repudiandae explicabo in exercitationem neque ea voluptas

    Sint molestiae quisquam est earum iusto ipsam magnam deleniti vel saepe reiciendis sint ad explicabo. earum omnis odio rem harum excepturi. consequatur magnam saepe ipsam voluptatem consequatur. dolorum earum et nobis perspiciatis enim est in dolorem magni placeat. quidem voluptatibus qui neque aut quidem autem et voluptates et natus facere consectetur et esse

    Et sapiente temporibus ea tenetur dolorum similique iure voluptates facere rem aut ullam asperiores aut. repudiandae officiis architecto aut aut in voluptatibus dolore ipsa impedit saepe accusantium. et repudiandae autem commodi. officia earum porro quisquam ipsam quisquam nulla aut minima facilis laudantium distinctio dignissimos

    Ea labore accusamus ut magnam qui iusto ullam sit aut quod molestiae. ea vero odit blanditiis quos ut ullam qui tempora quia dolorem. facilis ipsum quas molestiae molestiae sit. possimus eveniet nobis cumque omnis laborum. laboriosam dolor corporis eaque est sed labore. voluptatem voluptatibus et quia rerum. unde incidunt unde qui occaecati earum ducimus ut iure qui saepe labore quia

    Tempora enim aspernatur non recusandae aut laboriosam est aspernatur occaecati ad possimus. eum illum incidunt est non harum voluptatem sit. est a dolor maxime facilis ipsa quo modi nulla modi illum qui non commodi expedita. quas omnis a fuga dolores iusto dolor ex. magni minus sint voluptatibus explicabo consequuntur soluta maxime qui ea. officia iusto voluptatem fugit autem quia dolores ea sequi accusantium non accusamus odio ut eius

    Voluptatibus repellat animi eum qui quod et. unde quia odio et voluptatum dignissimos molestias minima alias necessitatibus sit illo eos. ut delectus ad omnis perspiciatis aut. vitae itaque natus molestias qui. illo ut exercitationem illo ut dolor

    Eveniet et omnis in tenetur modi molestias enim est reprehenderit itaque perferendis. architecto distinctio aut amet est et odio ut perspiciatis doloribus. accusamus veniam quas voluptatem assumenda nam rerum sed et similique ab consequatur. eius ut nemo enim omnis

    Aut vel dolorem sit iste repudiandae. harum dolore velit et amet. non quia blanditiis placeat nemo</p>

    <div id='two_part_mraid_ad_container_id' style="position: static; width: 300px; height: 50px; overflow: hidden">
      <div id="two_part_mraid_ad_container_id_wrapper">
        <iframe width="100%" height="100%" src='two_part_mraid/index.html' allowtransparency='true' seamless scrolling='no' style='z-index:10000; background:none;position: static; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
        <iframe width="100%" height="100%" allowtransparency='true' seamless scrolling='no' style='display:none; z-index:10000; background:none;position: fixed; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
      </div>
    </div>


    <script>function Controller(adNode) {
      this.adContainerNode = adNode;
      this.wrapperNode = adNode.childNodes[1];
      this.firstPartNode = this.wrapperNode.childNodes[1];
      this.secondPartNode = this.wrapperNode.childNodes[3];
      this.placementType = this.firstPartNode.style.position == 'fixed' ? 'interstital' : 'inline';
      this.initialWidth = this.adContainerNode.style.width
      this.initialHeight = this.adContainerNode.style.height
      this.closeIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAADb0lEQVR42u1XS0tbQRROqhQaUhRMTOKyG9OKWzUg5EG1bsRu/AXddiNtfSxqTLt1HQvd9hdkI2nUVLSQRekuxHcUQRBSXYXePCZ2vuGe25N4FZIbaBc5MMxl7syZ757znce12TrSkY78e7Hr84NQKNRNi4eHh8/K5fK7SqWyIscyG7HT09MI7Zudne3C2XaDMhQWCoXn1Wr1mxCicnOPSGCZy1+XL8x0WBL9CyFd0iKfcZkEdJNOp2uLi4ulkZERLRAIGGNhYUHb2tqqYg9EnvlEVma67JYsk0gkHFLxDi7Y2Ngoj42NleWyuG9gD/bqoHZ2d3cfM1B2K27qIjBra2u/6cLBwUHhdruFw+GoG1jDO9oXj8c13ao/5ubmHpHOptEQgclNBGZ4eNi4rK+v75Zl+BrtxVno0DRt3RJ/QGByE79A8kRMTEyoZ6/XawDweDxqjkQiYmlpqQ5UKpVSlrq4uHjTMiBEE8jJOYOLIEdHRwaQ/v5+AwzGwcGB2hOLxYy1cDhcLRaL4FNhdXXV1TQYqfQpQhvRRJzBPDk5KY6Pj9WF+/v7t1yWy+XUO5mLxPT0tFrz+/1q3tzcLMFKMoe9bhoQkh4OI7ShDGR1uVzGxVKpuhhzI5iTkxPR09Oj1tyuv+fm5+c1PUd9aBoQMjAOI89AGSIIs8/nMwDAbRAAyWaz6jmfzxsABgYGBD+LPKUDWm4F0DIOQwlXysmLsbe3J0i4tTjZTQBF2woI7qNnsgxZygy0CaD3bQPEv5ysA8uA4BBEGL33eX11gOB+HdDHljmE2kRW4UmPwIDAjZzi0Qc+EadkyqBS8qppQJKcIRxGoeRhHwwGDWsATG9vb13Y8+ibmpoS7Gx1e3sbJaSYyWQ8LfVB0ko/5YDbbiVG5Bmn02m4kXOG8hRPjKOjo6VarQbrrFspHS9hpWQyWeJlIBqNipmZmbrQ5ikBliEwrHSo/un6+jpkqQ+SX/TlruLKo41z5q7iqvdGvC9qqf3olm773th+DA0NmbYfAMTbDwYmbdIWt2YlWc+cBAru45y6a4Az5CaAkW5+aLWVbWw7u8l9IDqiDymBt6/IM6h9KMggsL43btIOt62vVkRH9N3X4MsAk9jLX6+ursbb3uTz3yAO7Pz8PGjyC7Qigbw9Ozt70vAxdltHOtKR/0T+AL2SJvDTWPbCAAAAAElFTkSuQmCC"
    }

    Controller.prototype = {
      expand : function(arguments) {
        if (! arguments["url"]) {
          this.firstPartNode.contentDocument.body.setAttribute("class", "expanded");
        } else {
          this.firstPartNode.style.display = 'none'
          this.secondPartNode.src = arguments["url"]
          this.secondPartNode.style.display = 'block'
        }

        if(!arguments["useCustomClose"]) {
          this._setClose()
        }

        this._resizeWrapper({ width: arguments.width, height: arguments.height, position: "fixed" });
        this._maximizeAdContainer()
      },

      resize : function(arguments) {
        this.firstPartNode.contentDocument.body.setAttribute("class", "resized");
        this._resizeWrapper(arguments)
      },

      _resizeWrapper : function(arguments) {
        var position = arguments.position || (arguments.x && arguments.width ? "fixed" : "static")
        if(arguments.width && arguments.height) {
          this.wrapperNode.style.width = arguments.width + "px";
          this.wrapperNode.style.height = arguments.height + "px";
        } else {
          this.wrapperNode.style.width = "auto";
          this.wrapperNode.style.height = "auto";
        }
        this.wrapperNode.style.position = position;
        this.wrapperNode.style.overflow = position == "static" ? "visible" : "hidden";
        this.wrapperNode.style.top = (arguments.x || 0) + "px";
        this.wrapperNode.style.left = (arguments.y || 0) + "px";
      },

      _maximizeAdContainer : function() {
        this.adContainerNode.style.width = "auto"
        this.adContainerNode.style.height = "auto"
        this.adContainerNode.style.position = "fixed"
        this.adContainerNode.style.top = 0
        this.adContainerNode.style.left = 0
        this.adContainerNode.style.right = 0
        this.adContainerNode.style.bottom = 0
        this.adContainerNode.style.background = "rgba(0, 0, 0, 0.6)"
      },

      _minimizeAdContainer : function() {
        this.adContainerNode.style.width = this.initialWidth
        this.adContainerNode.style.height = this.initialHeight
        this.adContainerNode.style.position = "static"
        this.adContainerNode.style.top = "initial"
        this.adContainerNode.style.left = "initial"
        this.adContainerNode.style.right = "initial"
        this.adContainerNode.style.bottom = "initial"
        this.adContainerNode.style.background = "none"
      },

      close : function(fromState) {
        if ( fromState == "default" ) {
          this.adContainerNode.style.display = 'none';
        } else {
          this.firstPartNode.contentDocument.body.removeAttribute("class", "expanded");
          this.firstPartNode.contentDocument.body.removeAttribute("class", "resized");
          this.secondPartNode.style.display = 'none';
          this.firstPartNode.style.display = 'block';
          var closeNode = this.wrapperNode.getElementsByClassName("mraidClose")[0]
          if(closeNode) {
            closeNode.remove();
          }
          this._resizeWrapper({});
          this._minimizeAdContainer();
        }
      },

      getCurrentPosition : function() {
        return {
          x: this.wrapperNode.offsetLeft,
          y: this.wrapperNode.offsetTop,
          width: this.wrapperNode.offsetWidth,
          height: this.wrapperNode.offsetHeight
        }
      },

      getPlacementType : function() {
        return this.placementType;
      },

      _setClose : function() {
        var closeNode = document.createElement('img');

        closeNode.setAttribute('src', this.closeIcon);
        closeNode.setAttribute('class', 'mraidClose');
        closeNode.setAttribute('onclick', 'mraid.close();');
        closeNode.style.position = 'absolute';
        closeNode.style.width = '50px';
        closeNode.style.height = '50px';
        closeNode.style.top = '0px';
        closeNode.style.right = '0px';
        closeNode.style.zIndex = '99999999999';

        this.wrapperNode.appendChild(closeNode);
      },

      postMessage: function(event) {
        if (event.target == "controller") {
          return this[event.action].apply(controller, [event.arguments])
        }
      }
    }

    window.controller = new Controller(document.getElementById('two_part_mraid_ad_container_id'));

    if ("localStorage" in window && window["localStorage"] !== null) { localStorage.setItem("madvertise", "0"); } (function() {
      xhr = new XMLHttpRequest();
      xhr.open('GET', 'http://localhost:1142/site/TestTokn/ad/QOnPBrZ2/pingback/jp4lmttz', true);
      xhr.send();
    }());
  </script>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
  <div id="debugger" style="position: fixed; right: 0; top: 0; background: #ddd">
    <iframe width="100%" height="100%" src='/debugger.html' allowtransparency='true' seamless scrolling='no' style='z-index:10000; background:none;position: static; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
  </div>

</body>
</html>
