<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Ads :: Expandable mraid</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    </head>
    <body>
      
      <h2>Two part mraid template</h2>
      <p>Qui enim et iure quibusdam sed voluptate dolore. quasi perferendis aut velit aliquam maxime aut fugiat sed sint reprehenderit omnis sed consequatur. ipsa repudiandae qui occaecati ea. commodi sunt accusantium adipisci ipsum sit veniam. alias soluta quo voluptates. sit facere iusto incidunt

Dolores vitae impedit libero ducimus consequatur qui libero et alias nihil. in ullam non et qui ut dolorum. voluptas earum adipisci nulla qui necessitatibus

Reiciendis in amet consequatur assumenda necessitatibus aut earum sint vero aut. et excepturi necessitatibus eaque dolor. sint ratione itaque iste. ipsam eius et saepe harum maiores et error natus et non illum. voluptatum et et quam rerum vitae. ullam beatae qui voluptas

Deserunt similique eveniet quas autem iure laborum. aut impedit non repellendus repellendus nostrum beatae deleniti qui corrupti sed adipisci. velit error dolore autem. laboriosam sed recusandae impedit voluptas quia quia non neque cum doloremque occaecati optio consequatur quae

Aut natus dolores et nemo et voluptas assumenda veniam nihil exercitationem quo praesentium qui aut. iusto doloribus pariatur ipsum qui quae cupiditate eum aut iure saepe aspernatur. tempora excepturi quisquam ratione aut. quidem doloribus ratione assumenda impedit sed asperiores illo quo. omnis blanditiis sit est placeat quibusdam recusandae inventore voluptatum

Aperiam et recusandae sunt nemo officiis quia aliquid ut et architecto iste eum velit vel. quasi cupiditate quia ad doloremque architecto aliquid corporis dolorem ullam ipsum. numquam culpa error earum saepe. rem repellat ex et et reiciendis illo atque id et eum eaque. itaque quis omnis ipsa exercitationem. est libero ea non occaecati ut qui officiis asperiores quia dolores neque quis

Quia ut quibusdam saepe illo magnam maxime blanditiis. quo non rerum sunt debitis odit maxime voluptatem suscipit placeat minus laudantium molestiae. autem cumque voluptatem qui in. doloribus quo omnis ab ut quo aut nobis et adipisci commodi rerum

Expedita qui aut magni facilis aut quo aperiam numquam culpa. eius facilis eum et unde voluptas minima ad ratione temporibus voluptas nam optio. eum autem ut commodi eligendi

Atque excepturi deserunt ratione dolores ut maxime ut eos. voluptatem quaerat maiores excepturi natus quia officia exercitationem quia atque nisi. ipsa est ipsum sed voluptatibus corporis qui dolor temporibus provident id et. tenetur et molestiae facere dignissimos reprehenderit dignissimos aliquid culpa in harum dolorum quibusdam suscipit enim. quidem quisquam quod nihil soluta id aut at

Praesentium architecto maxime expedita aut tempora alias beatae explicabo dolores id aut ea ut. velit beatae id iste facere aut architecto in dolore sit. laboriosam excepturi quae corrupti. quo quod architecto quia voluptatem necessitatibus id et. enim perferendis recusandae omnis ut sint totam et veritatis facilis explicabo repudiandae omnis fuga iusto. placeat quos voluptas sit et quasi est necessitatibus accusantium dolorum ipsum cumque iste enim quasi. unde necessitatibus totam et</p>

      <div id='ad_container_id' style="position: static; width: 320px; height: 50px; overflow: hidden">
  <div id="ad_container_id_wrapper">
    <iframe width="100%" height="100%" src='one_part_expand_mraid/index.html' allowtransparency='true' seamless scrolling='no' style='z-index:10000; background:none;position: static; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
    <iframe width="100%" height="100%" allowtransparency='true' seamless scrolling='no' style='display:none; z-index:10000; background:none;position: fixed; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
  </div>
</div>


      <script>function Controller(adNode) {
  this.adContainerNode = adNode;
  this.wrapperNode = adNode.childNodes[1];
  this.firstPartNode = this.wrapperNode.childNodes[1];
  this.secondPartNode = this.wrapperNode.childNodes[3];
  this.placementType = this.firstPartNode.style.position == 'fixed' ? 'interstital' : 'inline';
  this.initialWidth = this.adContainerNode.style.width
  this.initialHeight = this.adContainerNode.style.height
  this.closeIcon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAADb0lEQVR42u1XS0tbQRROqhQaUhRMTOKyG9OKWzUg5EG1bsRu/AXddiNtfSxqTLt1HQvd9hdkI2nUVLSQRekuxHcUQRBSXYXePCZ2vuGe25N4FZIbaBc5MMxl7syZ757znce12TrSkY78e7Hr84NQKNRNi4eHh8/K5fK7SqWyIscyG7HT09MI7Zudne3C2XaDMhQWCoXn1Wr1mxCicnOPSGCZy1+XL8x0WBL9CyFd0iKfcZkEdJNOp2uLi4ulkZERLRAIGGNhYUHb2tqqYg9EnvlEVma67JYsk0gkHFLxDi7Y2Ngoj42NleWyuG9gD/bqoHZ2d3cfM1B2K27qIjBra2u/6cLBwUHhdruFw+GoG1jDO9oXj8c13ao/5ubmHpHOptEQgclNBGZ4eNi4rK+v75Zl+BrtxVno0DRt3RJ/QGByE79A8kRMTEyoZ6/XawDweDxqjkQiYmlpqQ5UKpVSlrq4uHjTMiBEE8jJOYOLIEdHRwaQ/v5+AwzGwcGB2hOLxYy1cDhcLRaL4FNhdXXV1TQYqfQpQhvRRJzBPDk5KY6Pj9WF+/v7t1yWy+XUO5mLxPT0tFrz+/1q3tzcLMFKMoe9bhoQkh4OI7ShDGR1uVzGxVKpuhhzI5iTkxPR09Oj1tyuv+fm5+c1PUd9aBoQMjAOI89AGSIIs8/nMwDAbRAAyWaz6jmfzxsABgYGBD+LPKUDWm4F0DIOQwlXysmLsbe3J0i4tTjZTQBF2woI7qNnsgxZygy0CaD3bQPEv5ysA8uA4BBEGL33eX11gOB+HdDHljmE2kRW4UmPwIDAjZzi0Qc+EadkyqBS8qppQJKcIRxGoeRhHwwGDWsATG9vb13Y8+ibmpoS7Gx1e3sbJaSYyWQ8LfVB0ko/5YDbbiVG5Bmn02m4kXOG8hRPjKOjo6VarQbrrFspHS9hpWQyWeJlIBqNipmZmbrQ5ikBliEwrHSo/un6+jpkqQ+SX/TlruLKo41z5q7iqvdGvC9qqf3olm773th+DA0NmbYfAMTbDwYmbdIWt2YlWc+cBAru45y6a4Az5CaAkW5+aLWVbWw7u8l9IDqiDymBt6/IM6h9KMggsL43btIOt62vVkRH9N3X4MsAk9jLX6+ursbb3uTz3yAO7Pz8PGjyC7Qigbw9Ozt70vAxdltHOtKR/0T+AL2SJvDTWPbCAAAAAElFTkSuQmCC" 
}

Controller.prototype = {
  expand : function(arguments) {
    if (! arguments["url"]) {
      this.firstPartNode.contentDocument.body.setAttribute("class", "expanded");
    } else {
      this.firstPartNode.style.display = 'none'
      this.secondPartNode.src = arguments["url"]
      this.secondPartNode.style.display = 'block'
    }

    if(!arguments["useCustomClose"]) {
      this._setClose() 
    }

    this._resizeWrapper({ width: arguments.width, height: arguments.height, position: "fixed" });
    this._maximizeAdContainer()
  },

  resize : function(arguments) {
    this.firstPartNode.contentDocument.body.setAttribute("class", "resized");
    this._resizeWrapper(arguments)
  },

  _resizeWrapper : function(arguments) {
    var position = arguments.position || (arguments.x && arguments.width ? "fixed" : "static")
    if(arguments.width && arguments.height) {
      this.wrapperNode.style.width = arguments.width + "px";
      this.wrapperNode.style.height = arguments.height + "px";
    } else {
      this.wrapperNode.style.width = "auto";
      this.wrapperNode.style.height = "auto";
    }
    this.wrapperNode.style.position = position;
    this.wrapperNode.style.overflow = position == "static" ? "visible" : "hidden";
    this.wrapperNode.style.top = (arguments.x || 0) + "px";
    this.wrapperNode.style.left = (arguments.y || 0) + "px";
  },

  _maximizeAdContainer : function() {
    this.adContainerNode.style.width = "auto"
    this.adContainerNode.style.height = "auto"
    this.adContainerNode.style.position = "fixed"
    this.adContainerNode.style.top = 0
    this.adContainerNode.style.left = 0
    this.adContainerNode.style.right = 0
    this.adContainerNode.style.bottom = 0 
    this.adContainerNode.style.background = "rgba(0, 0, 0, 0.6)"
  },

  _minimizeAdContainer : function() {
    this.adContainerNode.style.width = this.initialWidth
    this.adContainerNode.style.height = this.initialHeight
    this.adContainerNode.style.position = "static"
    this.adContainerNode.style.top = "initial"
    this.adContainerNode.style.left = "initial" 
    this.adContainerNode.style.right = "initial" 
    this.adContainerNode.style.bottom = "initial" 
    this.adContainerNode.style.background = "none"
  },

  close : function(fromState) {
    if ( fromState == "default" ) {
      this.adContainerNode.style.display = 'none';
    } else {
      this.firstPartNode.contentDocument.body.removeAttribute("class", "expanded");
      this.firstPartNode.contentDocument.body.removeAttribute("class", "resized");
      this.secondPartNode.style.display = 'none';
      this.firstPartNode.style.display = 'block';
      var closeNode = this.wrapperNode.getElementsByClassName("mraidClose")[0]
      if(closeNode) {
        closeNode.remove();
      }
      this._resizeWrapper({});
      this._minimizeAdContainer();
    }
  },

  getCurrentPosition : function() {
    return {
      x: this.wrapperNode.offsetLeft,
      y: this.wrapperNode.offsetTop,
      width: this.wrapperNode.offsetWidth,
      height: this.wrapperNode.offsetHeight
    }
  },

  getPlacementType : function() {
    return this.placementType;
  },

  _setClose : function() {
    var closeNode = document.createElement('img');

    closeNode.setAttribute('src', this.closeIcon);
    closeNode.setAttribute('class', 'mraidClose');
    closeNode.setAttribute('onclick', 'mraid.close();');
    closeNode.style.position = 'absolute';
    closeNode.style.width = '50px';
    closeNode.style.height = '50px';
    closeNode.style.top = '0px';
    closeNode.style.right = '0px';
    closeNode.style.zIndex = '99999999999';

    this.wrapperNode.appendChild(closeNode);
  },

  postMessage: function(event) {
    if (event.target == "controller") {
      return this[event.action].apply(controller, [event.arguments])
    }
  }
}

window.controller = new Controller(document.getElementById('ad_container_id'));
</script>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
      <div id="debugger" style="position: fixed; right: 0; top: 0; background: #ddd">
        <iframe width="100%" height="100%" src='../debugger.html' allowtransparency='true' seamless scrolling='no' style='z-index:10000; background:none;position: static; overflow: hidden !important;border: none !important;background-color: none !important;'></iframe>
      </div>
    </body>
</html>
